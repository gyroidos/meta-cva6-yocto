From 40bd5cc95998ce19ba3ef61b87aa0d1820b6d399 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michael=20Wei=C3=9F?= <michael.weiss@aisec.fraunhofer.de>
Date: Thu, 11 Dec 2025 21:31:06 +0100
Subject: [PATCH 4/5] cva6: agilex7: moved constants from code to config
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Set constants such as SYS_LOAD_ADDR in both 32 and 64 bit cva6
agilex7_defconfig files instead of in code include/configs/
This is needed in current u-boot version. Otherwise this would
lead to redefinitions.

Signed-off-by: Michael Wei√ü <michael.weiss@aisec.fraunhofer.de>
---
 configs/openhwgroup_cv32a6_agilex7_defconfig |  9 +++++++--
 configs/openhwgroup_cv64a6_agilex7_defconfig |  9 +++++++--
 include/configs/openhwgroup_cva6_agilex7.h   | 11 +----------
 3 files changed, 15 insertions(+), 14 deletions(-)

diff --git a/configs/openhwgroup_cv32a6_agilex7_defconfig b/configs/openhwgroup_cv32a6_agilex7_defconfig
index 29b8f4a0d7e..2eaf998479c 100644
--- a/configs/openhwgroup_cv32a6_agilex7_defconfig
+++ b/configs/openhwgroup_cv32a6_agilex7_defconfig
@@ -1,4 +1,9 @@
 CONFIG_RISCV=y
+CONFIG_SYS_MALLOC_LEN=0x00800000
+CONFIG_HAS_CUSTOM_SYS_INIT_SP_ADDR=y
+CONFIG_CUSTOM_SYS_INIT_SP_ADDR=0x80400000
+CONFIG_SYS_BOOTM_LEN=0x04000000
+CONFIG_SYS_LOAD_ADDR=0x90000000
 CONFIG_DEFAULT_DEVICE_TREE="cv32a6_agilex7"
 CONFIG_TARGET_OPENHWGROUP_CVA6_AGILEX7=y
 CONFIG_RISCV_SMODE=y
@@ -37,5 +42,5 @@ CONFIG_SPI_FLASH_XMC=y
 # CONFIG_SPI_FLASH_USE_4K_SECTORS is not set
 CONFIG_SPI_FLASH_MTD=y
 CONFIG_SYS_NS16550=y
-# CONFIG_SPI=y
-#CONFIG_XILINX_SPI=y
+# CONFIG_SPI is not set
+# CONFIG_XILINX_SPI is not set
diff --git a/configs/openhwgroup_cv64a6_agilex7_defconfig b/configs/openhwgroup_cv64a6_agilex7_defconfig
index 05e3115edcb..384aeed8653 100644
--- a/configs/openhwgroup_cv64a6_agilex7_defconfig
+++ b/configs/openhwgroup_cv64a6_agilex7_defconfig
@@ -1,4 +1,9 @@
 CONFIG_RISCV=y
+CONFIG_SYS_MALLOC_LEN=0x00800000
+CONFIG_HAS_CUSTOM_SYS_INIT_SP_ADDR=y
+CONFIG_CUSTOM_SYS_INIT_SP_ADDR=0x80200000
+CONFIG_SYS_BOOTM_LEN=0x04000000
+CONFIG_SYS_LOAD_ADDR=0x90000000
 CONFIG_DEFAULT_DEVICE_TREE="cv64a6_agilex7"
 CONFIG_TARGET_OPENHWGROUP_CVA6_AGILEX7=y
 CONFIG_ARCH_RV64I=y
@@ -38,5 +43,5 @@ CONFIG_SPI_FLASH_XMC=y
 # CONFIG_SPI_FLASH_USE_4K_SECTORS is not set
 CONFIG_SPI_FLASH_MTD=y
 CONFIG_SYS_NS16550=y
-# CONFIG_SPI=y
-# CONFIG_XILINX_SPI=y
+# CONFIG_SPI is not set
+# CONFIG_XILINX_SPI is not set
diff --git a/include/configs/openhwgroup_cva6_agilex7.h b/include/configs/openhwgroup_cva6_agilex7.h
index 1c6640064bf..cb261d87b00 100644
--- a/include/configs/openhwgroup_cva6_agilex7.h
+++ b/include/configs/openhwgroup_cva6_agilex7.h
@@ -3,16 +3,7 @@
 
 #include <linux/sizes.h>
 
-#define CONFIG_SYS_SDRAM_BASE		0x80000000
-#define CONFIG_SYS_INIT_SP_ADDR		(CONFIG_SYS_SDRAM_BASE + SZ_2M)
-
-#define CONFIG_SYS_LOAD_ADDR		(CONFIG_SYS_SDRAM_BASE + SZ_2M)
-
-#define CONFIG_SYS_MALLOC_LEN       SZ_8M
-#define CONFIG_SYS_BOOTM_LEN        SZ_64M
-
-#define CONFIG_SYS_MAX_FLASH_BANKS 1
-#define CONFIG_SYS_FLASH_BASE 0x0
+#define CFG_SYS_SDRAM_BASE		0x80000000
 
 #define AGILEX7 1
 #endif
-- 
2.39.5

